<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ramadan Luxury Garland</title>

<style>
  :root{
    --bg1:#04040a;
    --bg2:#070817;
    --gold:#f6d365;
    --gold2:#ffb36b;
    --mint:#7cf7d4;
    --stroke: rgba(255,255,255,.16);
  }

  *{box-sizing:border-box}

  body{
    margin:0;
    overflow:hidden;
    font-family:"Noto Kufi Arabic",system-ui;
    background:
      radial-gradient(900px 600px at 20% 10%, rgba(246,211,101,.12), transparent 55%),
      radial-gradient(900px 600px at 80% 20%, rgba(124,247,212,.08), transparent 55%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    color:#fff;
  }

  canvas{
    position:fixed;
    inset:0;
    width:100%;
    height:100%;
  }

  /* UI */
  .ui{
    position:fixed;
    inset:0;
    pointer-events:none;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    padding:18px;
  }

  .badge{
    align-self:flex-start;
    display:flex;
    gap:10px;
    align-items:center;
    padding:10px 14px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.14);
    background: rgba(0,0,0,.35);
    backdrop-filter: blur(10px);
    font-size:12px;
    box-shadow: 0 18px 60px rgba(0,0,0,.35);
  }

  .dot{
    width:8px;height:8px;border-radius:50%;
    background: var(--mint);
    box-shadow: 0 0 18px rgba(124,247,212,.55);
  }

  .title{
    text-align:center;
    margin-bottom:24px;
    opacity:0;
    transform: translateY(26px) scale(.98);
    transition: opacity .15s linear, transform .15s linear;
    text-shadow: 0 18px 60px rgba(0,0,0,.75);
  }

  .title h1{
    margin:0;
    font-size: clamp(30px, 5vw, 74px);
    background: linear-gradient(90deg, var(--gold), #fff, var(--mint));
    -webkit-background-clip:text;
    color:transparent;
    letter-spacing:1px;
  }

  .title p{
    margin:14px 0 0;
    font-size: clamp(14px, 2vw, 20px);
    opacity:.85;
  }

  /* Garland rope line (visual) */
  .garlandLine{
    position:fixed;
    left:50%;
    top: 64px;
    transform: translateX(-50%);
    width: min(980px, 96vw);
    height: 4px;
    border-radius: 999px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent);
    opacity: .35;
    pointer-events:none;
  }

  /* Chain pull (new control) */
  .chainWrap{
    position:fixed;
    left:50%;
    top:0;
    transform: translateX(-50%);
    height: 100vh;
    width: 220px;
    pointer-events:none;
    z-index:10;
    display:flex;
    justify-content:center;
  }

  .chain{
    position:absolute;
    top:0;
    width: 10px;
    height: 56vh;
    border-radius: 999px;
    background: linear-gradient(180deg, rgba(246,211,101,.35), rgba(255,255,255,.05));
    border: 1px solid rgba(255,255,255,.10);
    box-shadow: 0 18px 60px rgba(0,0,0,.35);
    opacity: .85;
  }

  .charm{
    position:absolute;
    top: calc(56vh - 18px);
    width: 66px;
    height: 66px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.18);
    background:
      radial-gradient(circle at 30% 30%, rgba(246,211,101,.95), rgba(255,179,107,.55) 60%, rgba(255,255,255,.05));
    box-shadow: 0 18px 80px rgba(246,211,101,.16);
    display:grid;
    place-items:center;
    font-size: 22px;
    cursor: grab;
    pointer-events:auto;
    user-select:none;
    touch-action:none;
  }

  .charm:active{ cursor: grabbing; transform: translateY(6px) scale(.98); }

  .hint{
    position:fixed;
    left:50%;
    transform: translateX(-50%);
    bottom: 22px;
    width: min(640px, 92vw);
    text-align:center;
    color: rgba(255,255,255,.75);
    font-size: 12px;
    pointer-events:none;
    padding: 10px 12px;
    border-radius: 999px;
    border: 1px dashed rgba(255,255,255,.22);
    background: rgba(0,0,0,.20);
    backdrop-filter: blur(10px);
    z-index: 12;
  }

  .bar{
    position:fixed;
    left:50%;
    transform: translateX(-50%);
    bottom: 56px;
    width: min(640px, 92vw);
    height: 12px;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.14);
    background: rgba(255,255,255,.06);
    overflow:hidden;
    z-index:12;
    pointer-events:none;
  }
  .fill{
    height:100%;
    width:0%;
    background: linear-gradient(90deg, rgba(246,211,101,.92), rgba(124,247,212,.55));
    box-shadow: 0 0 30px rgba(246,211,101,.16);
  }
</style>
</head>

<body>

<canvas id="c"></canvas>

<div class="garlandLine"></div>

<div class="ui">
  <div class="badge">
    <span class="dot"></span>
    <span id="status">Ø§Ø³Ø­Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø© Ù„ØªØ´ØªØºÙ„ Ø²ÙŠÙ†Ø© Ø±Ù…Ø¶Ø§Ù† âœ¨</span>
  </div>

  <div class="title" id="title">
    <h1>Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…</h1>
    <p>Ù†Ø³Ø£Ù„ Ø§Ù„Ù„Ù‡ Ø£Ù† ÙŠÙ…Ù„Ø£ Ù„ÙŠØ§Ù„ÙŠÙƒÙ… Ù†ÙˆØ±Ù‹Ø§â€¦ ÙˆÙŠØ¬Ø¹Ù„ Ø±Ù…Ø¶Ø§Ù† Ø¨Ø¯Ø§ÙŠØ© Ø®ÙŠØ±Ù Ù„ÙƒÙ… âœ¨</p>
  </div>

  <div style="height:1px"></div>
</div>

<div class="chainWrap">
  <div class="chain" id="chain"></div>
  <div class="charm" id="charm">ğŸ•Œ</div>
</div>

<div class="bar"><div class="fill" id="fill"></div></div>
<div class="hint">Ø§Ø³Ø­Ø¨ Ù„Ù„Ø£Ø³ÙÙ„â€¦ Ø§Ù„Ø²ÙŠÙ†Ø© ÙÙˆÙ‚ Ø±Ø­ ØªÙ†ÙˆØ± ÙˆØªØ¸Ù‡Ø± Ø§Ù„ÙÙˆØ§Ù†ÙŠØ³ ÙˆØ§Ù„Ù†Øµ</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>
/* =========================
   SCENE
========================= */
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(45, innerWidth/innerHeight, 0.1, 200);
camera.position.set(0, 1.0, 10.0);

const renderer = new THREE.WebGLRenderer({ canvas: c, antialias:true, alpha:true });
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio, 2));

window.addEventListener("resize", ()=>{
  renderer.setSize(innerWidth, innerHeight);
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
});

/* =========================
   LIGHTS
========================= */
const ambient = new THREE.AmbientLight(0xffffff, 0.04);
scene.add(ambient);

const warm = new THREE.PointLight(0xffd88a, 0, 40);
warm.position.set(0, 4.0, 4.0);
scene.add(warm);

const rim = new THREE.DirectionalLight(0xbfefff, 0);
rim.position.set(-4, 2, -3);
scene.add(rim);

/* =========================
   STARS (COLORED)
========================= */
const starCount = 2600;
const starGeo = new THREE.BufferGeometry();
const starPos = new Float32Array(starCount*3);
const starCol = new Float32Array(starCount*3);

for(let i=0;i<starCount;i++){
  starPos[i*3]   = (Math.random()-0.5)*34;
  starPos[i*3+1] = (Math.random()-0.5)*20;
  starPos[i*3+2] = -Math.random()*55;

  const r = Math.random();
  let c = new THREE.Color("#ffffff");
  if(r < 0.15) c = new THREE.Color("#7cf7d4");
  else if(r < 0.35) c = new THREE.Color("#f6d365");

  starCol[i*3] = c.r;
  starCol[i*3+1] = c.g;
  starCol[i*3+2] = c.b;
}

starGeo.setAttribute("position", new THREE.BufferAttribute(starPos,3));
starGeo.setAttribute("color", new THREE.BufferAttribute(starCol,3));

const stars = new THREE.Points(
  starGeo,
  new THREE.PointsMaterial({
    size: 0.055,
    vertexColors:true,
    transparent:true,
    opacity:0.85,
    depthWrite:false
  })
);
stars.position.z = -6;
scene.add(stars);

/* =========================
   GOLD DUST
========================= */
const dustCount = 1200;
const dustGeo = new THREE.BufferGeometry();
const dustPos = new Float32Array(dustCount*3);

for(let i=0;i<dustCount;i++){
  dustPos[i*3]   = (Math.random()-0.5)*14;
  dustPos[i*3+1] = (Math.random()-0.5)*12;
  dustPos[i*3+2] = -Math.random()*12;
}
dustGeo.setAttribute("position", new THREE.BufferAttribute(dustPos,3));

const dust = new THREE.Points(
  dustGeo,
  new THREE.PointsMaterial({ color:0xffd88a, size:0.035, transparent:true, opacity:0.0 })
);
scene.add(dust);

/* =========================
   RAMADAN STRING LIGHTS (rope + bulbs)
========================= */
const garland = new THREE.Group();
scene.add(garland);

// rope curve points
const ropePts = [];
const ropeW = 9.0;
for(let i=0;i<=60;i++){
  const x = (i/60 - 0.5) * ropeW;
  const y = 3.2 + Math.sin(i/60 * Math.PI) * 0.55; // sag
  ropePts.push(new THREE.Vector3(x, y, -2.5));
}

const ropeCurve = new THREE.CatmullRomCurve3(ropePts);
const ropeGeo = new THREE.TubeGeometry(ropeCurve, 220, 0.03, 10, false);
const ropeMat = new THREE.MeshStandardMaterial({
  color: 0xffffff,
  roughness: 0.9,
  metalness: 0.0,
  transparent:true,
  opacity:0.0
});
const ropeMesh = new THREE.Mesh(ropeGeo, ropeMat);
garland.add(ropeMesh);

// bulbs along rope
const bulbs = [];
for(let i=0;i<16;i++){
  const t = i/15;
  const p = ropeCurve.getPoint(t);

  const bulbMesh = new THREE.Mesh(
    new THREE.SphereGeometry(0.12, 18, 18),
    new THREE.MeshStandardMaterial({
      color: 0xffffff,
      emissive: 0xffd88a,
      emissiveIntensity: 0.0,
      roughness: 0.25,
      metalness: 0.0,
      transparent:true,
      opacity:0.0
    })
  );

  const bulbLight = new THREE.PointLight(0xffe7b0, 0.0, 7, 2);
  bulbMesh.position.copy(p);
  bulbLight.position.copy(p);

  garland.add(bulbMesh);
  garland.add(bulbLight);

  bulbs.push({ bulbMesh, bulbLight, baseT:t });
}

/* =========================
   LANTERNS
========================= */
function metal(hex, rough=0.22, metalness=0.95){
  return new THREE.MeshStandardMaterial({
    color: new THREE.Color(hex),
    roughness: rough,
    metalness: metalness
  });
}

function createLantern(scale=1){
  const g = new THREE.Group();

  const body = new THREE.Mesh(
    new THREE.CylinderGeometry(0.28,0.32,0.70,52,1,true),
    metal("#fda085", 0.38, 0.85)
  );

  const ribsMat = metal("#f6d365", 0.20, 1.0);
  for(let i=0;i<12;i++){
    const rib = new THREE.Mesh(
      new THREE.CylinderGeometry(0.006,0.006,0.78,10),
      ribsMat
    );
    const a = (i/12)*Math.PI*2;
    rib.position.set(Math.cos(a)*0.31, 0, Math.sin(a)*0.31);
    g.add(rib);
  }

  const cap = new THREE.Mesh(
    new THREE.SphereGeometry(0.22,42,30),
    metal("#f6d365", 0.18, 1.0)
  );
  cap.scale.set(1.18,0.68,1.18);
  cap.position.y = 0.42;

  const cap2 = cap.clone();
  cap2.position.y = -0.42;

  const hook = new THREE.Mesh(
    new THREE.TorusGeometry(0.12,0.02,18,42),
    metal("#ffffff", 0.25, 0.95)
  );
  hook.position.y = 0.72;
  hook.rotation.x = Math.PI/2;

  const light = new THREE.PointLight(0xffe7b0, 0.0, 12, 2);
  light.position.set(0,0,0);

  g.add(body, cap, cap2, hook, light);
  g.scale.setScalar(scale);

  return { g, light };
}

const A = createLantern(1.05);
const B = createLantern(0.92);
const Cc = createLantern(0.78);

// hidden at start
A.g.position.set(-3.6, 1.1, -16);
B.g.position.set( 3.6, 0.9, -16);
Cc.g.position.set(0.0, -0.2, -16);

scene.add(A.g, B.g, Cc.g);

/* =========================
   REVEAL CONTROL
========================= */
let reveal = 0.0;
let target = 0.0;

const charm = document.getElementById("charm");
const chain = document.getElementById("chain");
const fill = document.getElementById("fill");
const status = document.getElementById("status");
const title = document.getElementById("title");

let dragging = false;
let startY = 0;
let startVal = 0;

function clamp01(x){ return Math.max(0, Math.min(1, x)); }

function setCharm(px){
  charm.style.transform = `translateY(${px}px)`;
  chain.style.height = `calc(56vh + ${px}px)`;
}

function setUI(v){
  fill.style.width = (v*100).toFixed(1) + "%";
  title.style.opacity = Math.min(1, Math.max(0, (v - 0.15) / 0.35));
  title.style.transform = `translateY(${26 - v*26}px) scale(${0.98 + v*0.02})`;

  if(v < 0.05) status.textContent = "Ø§Ø³Ø­Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø© Ù„ØªØ´ØªØºÙ„ Ø²ÙŠÙ†Ø© Ø±Ù…Ø¶Ø§Ù† âœ¨";
  else if(v < 0.75) status.textContent = "ÙˆØ§Ùˆâ€¦ Ø§Ù„Ø²ÙŠÙ†Ø© Ø¹Ù… ØªÙ†ÙˆØ± ğŸ˜";
  else status.textContent = "ÙØ®Ù… ğŸ”¥ Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…!";
}

charm.addEventListener("pointerdown", (e)=>{
  dragging = true;
  startY = e.clientY;
  startVal = target;
  charm.setPointerCapture(e.pointerId);
});

window.addEventListener("pointermove", (e)=>{
  if(!dragging) return;

  const maxPull = innerHeight * 0.42;
  const dy = (e.clientY - startY);
  const delta = dy / maxPull;

  target = clamp01(startVal + delta);
  setCharm(target * maxPull);
  setUI(target);
}, {passive:true});

window.addEventListener("pointerup", ()=>{
  dragging = false;
}, {passive:true});

window.addEventListener("pointercancel", ()=>{
  dragging = false;
}, {passive:true});

setCharm(0);
setUI(0);

/* =========================
   ANIMATE
========================= */
const clock = new THREE.Clock();

function animate(){
  requestAnimationFrame(animate);
  const t = clock.getElapsedTime();

  reveal = THREE.MathUtils.lerp(reveal, target, 0.07);

  // lights
  ambient.intensity = 0.02 + reveal*0.70;
  warm.intensity    = reveal*2.8;
  rim.intensity     = reveal*0.55;

  // dust
  dust.material.opacity = reveal*0.55;
  dust.rotation.y = t*0.08;

  // rope visible
  ropeMat.opacity = reveal*0.55;

  // bulbs
  bulbs.forEach((b, i)=>{
    const twinkle = 0.65 + Math.sin(t*2.2 + i*0.6)*0.35;
    b.bulbMesh.material.opacity = reveal;
    b.bulbMesh.material.emissiveIntensity = reveal * (1.8 + twinkle*0.9);
    b.bulbLight.intensity = reveal * (2.0 + twinkle*1.6);
  });

  // lanterns appear
  A.g.position.z  = THREE.MathUtils.lerp(-16, -0.8, reveal);
  B.g.position.z  = THREE.MathUtils.lerp(-16, -0.5, reveal);
  Cc.g.position.z = THREE.MathUtils.lerp(-16, -1.0, reveal);

  // lantern glow
  const glow = 3.8*reveal;
  A.light.intensity = glow*1.2;
  B.light.intensity = glow*1.1;
  Cc.light.intensity = glow*0.95;

  // swing
  const swing = 0.03 + reveal*0.13;
  A.g.rotation.z = Math.sin(t*0.9) * swing;
  B.g.rotation.z = Math.sin(t*1.05 + 1.2) * swing*0.92;
  Cc.g.rotation.z = Math.sin(t*1.1 + 2.2) * swing*0.85;

  // drift
  stars.rotation.y = t*0.02;

  // camera cinematic
  camera.position.x = Math.sin(t*0.12)*0.20;
  camera.position.y = 1.0 + Math.sin(t*0.10)*0.10;
  camera.lookAt(0, 0.7, 0);

  renderer.render(scene, camera);
}

animate();
</script>

</body>
</html>
