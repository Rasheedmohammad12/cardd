<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Ramadan Crescent 3D</title>
  <style>
    :root{
      --bg1:#05060a; --bg2:#0a0b14;
      --gold:#f6d365; --mint:#7cf7d4; --text:#f4f6ff;
      --glass:rgba(255,255,255,.07); --stroke:rgba(255,255,255,.12);
      --shadow: 0 22px 70px rgba(0,0,0,.55);
      --radius:22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Kufi Arabic", Arial;
      background:
        radial-gradient(1100px 700px at 20% 10%, rgba(246,211,101,.16), transparent 55%),
        radial-gradient(900px 600px at 80% 25%, rgba(124,247,212,.10), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow:hidden;
      display:grid;
      place-items:center;
      padding:18px;
    }

    .app{
      width:min(980px, 100%);
      display:grid;
      gap:14px;
      grid-template-columns: 1fr;
    }
    header{
      border:1px solid var(--stroke);
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      padding:14px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{display:flex;gap:10px;align-items:center;min-width:0}
    .logo{
      width:40px;height:40px;border-radius:14px;
      background: radial-gradient(circle at 30% 30%, rgba(246,211,101,.95), rgba(124,247,212,.25) 70%, rgba(255,255,255,.06));
      border:1px solid rgba(255,255,255,.18);
      box-shadow: 0 12px 30px rgba(246,211,101,.18);
    }
    h1{margin:0;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .sub{margin:2px 0 0;font-size:12px;color:rgba(244,246,255,.72);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    .stageCard{
      border:1px solid var(--stroke);
      background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.02));
      border-radius: calc(var(--radius) + 6px);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }

    /* Ø¥Ø·Ø§Ø± Ø¹Ù…ÙˆØ¯ÙŠ 9:16 (Ø±ÙŠÙ„Ø²) */
    .frame{
      width:min(520px, 100%);
      margin: 14px auto 18px;
      aspect-ratio: 9 / 16;
      border-radius: 28px;
      border:1px solid rgba(255,255,255,.16);
      overflow:hidden;
      position:relative;
      background: radial-gradient(900px 600px at 50% 15%, rgba(246,211,101,.10), transparent 60%),
                  radial-gradient(900px 700px at 50% 110%, rgba(124,247,212,.08), transparent 60%),
                  linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.60));
    }
    canvas{width:100%;height:100%;display:block}

    .ui{
      position:absolute; inset:0;
      pointer-events:none;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      padding:16px;
    }
    .chip{
      align-self:flex-start;
      pointer-events:none;
      display:flex; align-items:center; gap:10px;
      padding:9px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.33);
      backdrop-filter: blur(8px);
      font-size:12px;
      color:rgba(255,255,255,.92);
    }
    .dot{width:8px;height:8px;border-radius:999px;background:var(--mint);box-shadow:0 0 18px rgba(124,247,212,.5)}

    .title{
      text-align:center;
      margin-bottom:8px;
      text-shadow: 0 12px 36px rgba(0,0,0,.6);
    }
    .title h2{
      margin:0;
      font-size: clamp(18px, 3vw, 30px);
      background: linear-gradient(90deg, var(--gold), #fff, var(--mint));
      -webkit-background-clip:text;background-clip:text;color:transparent;
      filter: drop-shadow(0 18px 30px rgba(246,211,101,.12));
    }
    .title p{margin:6px 0 0;font-size:13px;color:rgba(255,255,255,.82)}

    .pull{
      pointer-events:none;
      text-align:center;
      margin: 0 auto 2px;
      width: 100%;
      max-width: 420px;
      font-size: 12px;
      color: rgba(255,255,255,.78);
      padding:10px 12px;
      border-radius: 999px;
      border: 1px dashed rgba(255,255,255,.22);
      background: rgba(0,0,0,.20);
      backdrop-filter: blur(8px);
    }

    .bar{
      position:absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 18px;
      width: 56%;
      height: 10px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      overflow:hidden;
      pointer-events:none;
    }
    .fill{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(246,211,101,.9), rgba(124,247,212,.55));
      box-shadow: 0 0 24px rgba(246,211,101,.18);
    }

    .footer{
      padding: 0 16px 14px;
      color: rgba(255,255,255,.60);
      font-size: 11px;
      line-height:1.6;
      text-align:center;
    }

    .hint{
      pointer-events:none;
      position:absolute;
      inset:auto 16px 16px 16px;
      text-align:center;
      display:flex;
      justify-content:center;
    }

    @media (min-width: 980px){
      .app{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo"></div>
        <div style="min-width:0">
          <h1>Ramadan Crescent â€” Pull to Reveal</h1>
          <div class="sub">Ø§Ø³Ø­Ø¨ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¥Ø·Ø§Ø± Ù„ÙŠØ·Ù„Ø¹ Ø§Ù„Ù‡Ù„Ø§Ù„ 3D (ÙØ®Ù… âœ¨)</div>
        </div>
      </div>
      <div style="font-size:12px;color:rgba(244,246,255,.7)">3D â€¢ ØªÙØ§Ø¹Ù„ â€¢ 9:16</div>
    </header>

    <section class="stageCard">
      <div class="frame" id="frame">
        <canvas id="c"></canvas>

        <div class="ui">
          <div class="chip"><span class="dot"></span><span id="status">Ø§Ø³Ø­Ø¨ Ù„ØªØ·Ù„Ø¹ Ø§Ù„Ù‡Ù„Ø§Ù„</span></div>

          <div class="title">
            <h2>Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…</h2>
            <p>Ø§Ø³Ø­Ø¨ Ù„Ù„Ø£Ø¹Ù„Ù‰/Ù„Ù„Ø£Ø³ÙÙ„â€¦ Ø§Ù„Ù‡Ù„Ø§Ù„ Ø±Ø­ ÙŠØ·Ù„Ø¹ Ù‚Ø¯Ø§Ù…Ùƒ âœ¨</p>
          </div>

          <div class="hint">
            <div class="pull">Ø§Ø³Ø­Ø¨ Ø¯Ø§Ø®Ù„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ: <b>Pull</b> Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‡Ù„Ø§Ù„ â€” Ø­Ø±Ù‘Ø± Ù„ØªØ«Ø¨ÙŠØª</div>
          </div>
        </div>

        <div class="bar"><div class="fill" id="fill"></div></div>
      </div>

      <div class="footer">
        Ù„Ùˆ Ø¨Ø¯Ùƒ â€œØ·Ù„Ø¹Ø©â€ Ø£Ù‚ÙˆÙ‰: Ø²ÙØ¯ Ø§Ù„Ø³Ø­Ø¨ Ù„Ù„Ø£Ø¹Ù„Ù‰ Ø£ÙƒØ«Ø±. Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø§Ø³Ø­Ø¨ Ø¨Ø¥ØµØ¨Ø¹Ùƒ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¥Ø·Ø§Ø±.
      </div>
    </section>
  </div>

  <script type="module">
    import * as THREE from "https://unpkg.com/three@0.160.0/build/three.module.js";

    const canvas = document.getElementById("c");
    const frame  = document.getElementById("frame");
    const fill   = document.getElementById("fill");
    const status = document.getElementById("status");

    // Renderer
    const renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:true });
    renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
    renderer.outputColorSpace = THREE.SRGBColorSpace;
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 1.06;

    // Scene + camera
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45, 9/16, 0.1, 120);
    camera.position.set(0, 0.85, 6.2);

    // Lights (gold cinematic)
    const amb = new THREE.AmbientLight(0xffffff, 0.55);
    scene.add(amb);

    const key = new THREE.DirectionalLight(0xfff1cf, 1.35);
    key.position.set(2.8, 3.2, 2.5);
    scene.add(key);

    const rim = new THREE.DirectionalLight(0xcfefff, 0.85);
    rim.position.set(-3.2, 1.4, -2.5);
    scene.add(rim);

    // Helpers
    const root = new THREE.Group();
    scene.add(root);

    function makeMetal(hex, rough=0.18, metal=1.0){
      return new THREE.MeshStandardMaterial({
        color: new THREE.Color(hex),
        roughness: rough,
        metalness: metal
      });
    }

    // --------- Stars (particles) ----------
    const starCount = 800;
    const g = new THREE.BufferGeometry();
    const pos = new Float32Array(starCount*3);
    const col = new Float32Array(starCount*3);

    for(let i=0;i<starCount;i++){
      pos[i*3+0] = (Math.random()-0.5)*9.5;
      pos[i*3+1] = (Math.random()-0.5)*12.0;
      pos[i*3+2] = -Math.random()*14.0;

      const t = Math.random();
      const c = new THREE.Color().setHSL(0.12 + 0.2*t, 0.9, 0.65);
      if(Math.random()<0.25) c.set("#7cf7d4");
      if(Math.random()<0.12) c.set("#ffffff");
      col[i*3+0]=c.r; col[i*3+1]=c.g; col[i*3+2]=c.b;
    }
    g.setAttribute("position", new THREE.BufferAttribute(pos,3));
    g.setAttribute("color", new THREE.BufferAttribute(col,3));

    const stars = new THREE.Points(g, new THREE.PointsMaterial({
      size: 0.03,
      vertexColors:true,
      transparent:true,
      opacity:0.95,
      depthWrite:false
    }));
    stars.position.z = -3.0;
    scene.add(stars);

    // --------- Crescent 3D ----------
    // Premium fake crescent: torus arc + inner dark torus offset + small star
    const crescent = new THREE.Group();

    const arcGeo = new THREE.TorusGeometry(1.2, 0.23, 72, 260, Math.PI * 1.52);
    const arc = new THREE.Mesh(arcGeo, makeMetal("#f6d365", 0.16, 1));
    arc.rotation.z = Math.PI * 0.18;
    arc.rotation.x = Math.PI * 0.06;

    const cutGeo = new THREE.TorusGeometry(0.98, 0.19, 72, 260, Math.PI * 1.52);
    const cut = new THREE.Mesh(cutGeo, makeMetal("#0b0c14", 0.85, 0.08));
    cut.position.set(0.14, -0.03, 0.08);
    cut.rotation.copy(arc.rotation);

    const star = new THREE.Mesh(
      new THREE.IcosahedronGeometry(0.16, 1),
      makeMetal("#ffffff", 0.28, 0.9)
    );
    star.position.set(1.08, 0.88, 0.25);

    crescent.add(arc, cut, star);
    crescent.position.set(0, 0.45, 0);
    root.add(crescent);

    // Floor glow (subtle)
    const glow = new THREE.Mesh(
      new THREE.RingGeometry(0.8, 2.6, 90),
      new THREE.MeshStandardMaterial({
        color: new THREE.Color("#fda085"),
        transparent:true,
        opacity:0.10,
        roughness: 1.0,
        metalness: 0.0,
        side: THREE.DoubleSide
      })
    );
    glow.rotation.x = Math.PI/2;
    glow.position.y = -0.8;
    root.add(glow);

    // --------- Pull-to-reveal interaction ----------
    let reveal = 0.0; // 0..1
    let targetReveal = 0.0;

    let isDown = false;
    let startY = 0;
    let baseReveal = 0;

    function clamp01(x){ return Math.max(0, Math.min(1, x)); }

    function setStatus(){
      if(reveal < 0.02) status.textContent = "Ø§Ø³Ø­Ø¨ Ù„ØªØ·Ù„Ø¹ Ø§Ù„Ù‡Ù„Ø§Ù„";
      else if(reveal < 0.7) status.textContent = "Ù…Ù…ØªØ§Ø²â€¦ ÙƒÙ…Ù„ Ø³Ø­Ø¨ âœ¨";
      else status.textContent = "ÙØ®Ù… ğŸ”¥ Ø«Ø¨ØªÙ‘Ù‡ Ø£Ùˆ Ù„ÙÙ‘Ù‡";
    }

    function onDown(clientY){
      isDown = true;
      startY = clientY;
      baseReveal = targetReveal;
    }
    function onMove(clientY){
      if(!isDown) return;
      const rect = frame.getBoundingClientRect();
      const dy = (startY - clientY); // up = positive
      // normalize by frame height
      const delta = dy / rect.height; // ~ -1..1
      targetReveal = clamp01(baseReveal + delta * 1.35);
      fill.style.width = (targetReveal*100).toFixed(1) + "%";
    }
    function onUp(){
      isDown = false;
    }

    frame.addEventListener("pointerdown", (e)=>{ frame.setPointerCapture(e.pointerId); onDown(e.clientY); }, {passive:true});
    frame.addEventListener("pointermove", (e)=> onMove(e.clientY), {passive:true});
    frame.addEventListener("pointerup", onUp, {passive:true});
    frame.addEventListener("pointercancel", onUp, {passive:true});
    frame.addEventListener("mouseleave", onUp, {passive:true});

    // --------- Resize ----------
    function resize(){
      const r = frame.getBoundingClientRect();
      const w = Math.max(1, Math.floor(r.width));
      const h = Math.max(1, Math.floor(r.height));
      renderer.setSize(w, h, false);
      camera.aspect = w/h;
      camera.updateProjectionMatrix();
    }
    new ResizeObserver(resize).observe(frame);
    resize();

    // --------- Animate ----------
    const clock = new THREE.Clock();

    function animate(){
      const t = clock.getElapsedTime();

      // smooth reveal
      reveal = THREE.MathUtils.lerp(reveal, targetReveal, 0.08);
      setStatus();

      // Pull effect: from far+small+hidden -> near+large+bright
      const z = THREE.MathUtils.lerp(-2.2, 1.15, reveal);
      const s = THREE.MathUtils.lerp(0.70, 1.22, reveal);
      const y = THREE.MathUtils.lerp(-0.35, 0.55, reveal);

      crescent.position.z = z;
      crescent.position.y = y;
      crescent.scale.setScalar(s);

      // add premium motion always
      crescent.rotation.y = t * (0.35 + reveal*0.9);
      crescent.rotation.x = 0.05 + Math.sin(t*0.8)*0.05;

      star.rotation.y = -t * 1.2;
      star.rotation.x =  t * 1.0;

      // stars drift
      stars.rotation.y = t * 0.03;
      stars.rotation.x = Math.sin(t*0.08) * 0.03;

      // glow reacts
      glow.material.opacity = 0.06 + reveal*0.12;
      glow.scale.setScalar(1.0 + reveal*0.16);

      // light reacts (a bit)
      key.intensity = 1.1 + reveal*0.6;
      amb.intensity = 0.50 + reveal*0.20;

      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }
    animate();

    // Start bar at 0
    fill.style.width = "0%";
  </script>
</body>
</html>
